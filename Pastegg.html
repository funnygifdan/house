<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>Door Test</title>
<style>
  /* ===== PAGE BACKGROUNDS ===== */
  html, body {
    margin: 0; padding: 0; height: 100%; width: 100%;
  }
  body {
    background: url("outside.jpg") no-repeat center center fixed;
    background-size: cover;      /* cover whole screen */
    overflow: hidden;
    transition: background-image 300ms ease;
  }
  body.inside {
    background: url("inside.jpg") no-repeat center center fixed;
    background-size: cover;      /* cover whole screen */
  }

  /* ===== SCENE / CENTER ===== */
  .scene {
    position: relative;
    width: 100%; height: 100%;
    display: flex; justify-content: center; align-items: center;
    perspective: 1200px;
  }

  /* Walk zoom vibe (optional) */
  .scene.walk1 { transform: scale(1.03); transition: transform 180ms ease; }
  .scene.walk2 { transform: scale(1.06); }

  /* ===== DOOR WRAP (so we can align the peek exactly to door) ===== */
  .door-wrap {
    position: relative; /* positioning context for peek */
    pointer-events: none; /* disabled until we "reach" it */
  }
  body.ready .door-wrap { pointer-events: auto; } /* door becomes clickable after walk taps */

  /* ===== DOOR (keep your sizing) ===== */
  .door {
    position: relative;
    width: 100px;   /* keep your size */
    height: 190px;  /* keep your size */
    background: #663300;
    border: 5px solid #331a00;
    box-shadow: inset -10px 0 20px rgba(0,0,0,0.5);
    transform-origin: left center;
    transition: transform 1s ease;
    cursor: pointer;
  }
  .door.open { transform: rotateY(-100deg); }

  .door::after {
    content: "";
    position: absolute; right: 20px; top: 50%;
    width: 20px; height: 20px;
    background: gold; border-radius: 50%;
    transform: translateY(-50%);
  }

  /* ===== INSIDE PEEK (exactly the doorâ€™s size & position) ===== */
  .inside-peek {
    position: absolute; left: 0; top: 0;
    width: 100%; height: 100%;
    background: url("inside.jpg") no-repeat center center;
    background-size: cover;
    opacity: 0;
    pointer-events: none;
    transition: opacity 350ms ease 650ms; /* fades in after most of the swing */
  }
  /* when door is open, show peek & allow click */
  .door.open + .inside-peek {
    opacity: 1;
    pointer-events: auto;
    cursor: pointer;
  }

  /* ===== INSIDE OVERLAY (old messageâ€”now unused; leaving in case you want it) ===== */
  .inside-msg {
    position: absolute; inset: 0;
    display: flex; justify-content: center; align-items: center;
    color: white; font-size: 2rem;
    opacity: 0; pointer-events: none; transition: opacity 300ms ease;
  }
  body.inside .inside-msg { opacity: 1; pointer-events: auto; }

  /* ===== HINT ===== */
  .hint {
    position: absolute; left: 50%; bottom: 2.2vh;
    transform: translateX(-50%);
    padding: .55em .9em;
    font: 600 14px/1.1 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    color: #fff; background: rgba(0,0,0,.35);
    backdrop-filter: blur(4px);
    border-radius: 8px;
    user-select: none;
  }
  body.inside .hint { display: none; }
</style>
</head>
<body>
  <div class="scene" id="scene">
    <div class="door-wrap" id="doorWrap">
      <div class="door" id="door"></div>
      <div class="inside-peek" id="insidePeek" title="Tap to enter"></div>
    </div>
    <div class="inside-msg" id="insideMsg">Youâ€™re inside the house ðŸ“š</div>
    <div class="hint" id="hint">tap to walk â€¢ tap door â€¢ then tap inside</div>
  </div>

<script>
  /* ===== CONFIG ===== */
  const requiredWalkTaps = 2; // you asked for two taps from the sidewalk
  let roamingSteps = 0;       // reserved for future roaming fun

  /* ===== ELEMENTS ===== */
  const body = document.body;
  const scene = document.getElementById('scene');
  const door = document.getElementById('door');
  const doorWrap = document.getElementById('doorWrap');
  const insidePeek = document.getElementById('insidePeek');
  const hint = document.getElementById('hint');

  /* ===== STATE =====
     0 = sidewalk (walk taps)
     1 = at door (door closed, clickable)
     2 = door open + peek visible (pause)
     3 = inside (full switch)
  */
  let state = 0;

  function setState(s){
    state = s;
    switch(state){
      case 0:
        body.classList.remove('ready','inside');
        scene.classList.remove('walk1','walk2');
        door.classList.remove('open');
        doorWrap.style.display = 'block';
        hint.textContent = 'tap to walk â€¢ tap door â€¢ then tap inside';
        break;
      case 1:
        body.classList.add('ready');
        hint.textContent = 'tap the door';
        break;
      case 2:
        hint.textContent = 'tap inside to enter';
        break;
      case 3:
        body.classList.remove('ready');
        body.classList.add('inside');
        doorWrap.style.display = 'none'; // hide the physical door group
        break;
    }
  }
  setState(0);

  /* ===== WALK TAPS (on scene, not on door) ===== */
  scene.addEventListener('click', (e) => {
    if (state !== 0) return;

    // If someone taps near the door before it's "ready", we still count as walking
    roamingSteps++;
    if (roamingSteps === 1) scene.classList.add('walk1');
    if (roamingSteps >= requiredWalkTaps) {
      scene.classList.add('walk2');
      setState(1); // reached the door
    }
  });

  /* Stop scene click from counting when actually clicking the door area */
  doorWrap.addEventListener('click', (e) => e.stopPropagation(), true);

  /* ===== DOOR CLICK: swing open, show peek (no teleport yet) ===== */
  door.addEventListener('click', () => {
    if (state !== 1) return;
    door.classList.add('open');
    setState(2);
  });

  /* ===== ENTER: click the inside preview to go fully inside ===== */
  insidePeek.addEventListener('click', (e) => {
    if (state !== 2) return;
    setState(3);
  });

  /* ===== Keyboard helpers (optional) ===== */
  window.addEventListener('keydown', (e)=>{
    if (e.code === 'Space') { e.preventDefault(); scene.click(); }
    if (e.code === 'Enter') {
      if (state === 1) door.click();
      else if (state === 2) insidePeek.click();
    }
  });
</script>
</body>
</html>